(function(t){function e(e){for(var r,i,a=e[0],c=e[1],l=e[2],d=0,p=[];d<a.length;d++)i=a[d],Object.prototype.hasOwnProperty.call(o,i)&&o[i]&&p.push(o[i][0]),o[i]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(t[r]=c[r]);u&&u(e);while(p.length)p.shift()();return s.push.apply(s,l||[]),n()}function n(){for(var t,e=0;e<s.length;e++){for(var n=s[e],r=!0,a=1;a<n.length;a++){var c=n[a];0!==o[c]&&(r=!1)}r&&(s.splice(e--,1),t=i(i.s=n[0]))}return t}var r={},o={app:0},s=[];function i(e){if(r[e])return r[e].exports;var n=r[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=t,i.c=r,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(n,r,function(e){return t[e]}.bind(null,r));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="/sons/";var a=window["webpackJsonp"]=window["webpackJsonp"]||[],c=a.push.bind(a);a.push=e,a=a.slice();for(var l=0;l<a.length;l++)e(a[l]);var u=c;s.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"0a36":function(t,e,n){"use strict";var r=n("5fef"),o=n.n(r);o.a},"251f":function(t,e,n){"use strict";var r=n("b912"),o=n.n(r);o.a},"44bd":function(t,e,n){"use strict";var r=n("850a"),o=n.n(r);o.a},"56d7":function(t,e,n){"use strict";n.r(e);n("cadf"),n("551c"),n("f751"),n("097d");var r=n("2b0e"),o=n("9483");Object(o["a"])("".concat("/sons/","service-worker.js"),{ready:function(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},registered:function(){console.log("Service worker has been registered.")},cached:function(){console.log("Content has been cached for offline use.")},updatefound:function(){console.log("New content is downloading.")},updated:function(){console.log("New content is available; please refresh.")},offline:function(){console.log("No internet connection found. App is running in offline mode.")},error:function(t){console.error("Error during service worker registration:",t)}});n("ac6a"),n("7514");var s=n("2f62"),i=[{id:"aula",name:"Saula de Aula",sounds:[{register:"agudos",icon:"banks/aula/icons/snap.svg",sample:"snap.mp3"},{register:"agudos",icon:"holder.js/40x40?text=S2",sample:"snap.mp3"},{register:"agudos",icon:"holder.js/40x40?text=S3",sample:"snap.mp3"},{register:"agudos",icon:"holder.js/40x40?text=S3",sample:"snap.mp3"},{register:"medios",icon:"banks/aula/icons/clap.svg",sample:"clap.mp3"},{register:"medios",icon:"holder.js/40x40?text=S6",sample:"snap.mp3"},{register:"medios",icon:"holder.js/40x40?text=S7",sample:"snap.mp3"},{register:"medios",icon:"holder.js/40x40?text=S7",sample:"snap.mp3"},{register:"graves",icon:"banks/aula/icons/kick.svg",sample:"kick.mp3"},{register:"graves",icon:"holder.js/40x40?text=S10",sample:"snap.mp3"},{register:"graves",icon:"holder.js/40x40?text=S11",sample:"snap.mp3"},{register:"graves",icon:"holder.js/40x40?text=S11",sample:"snap.mp3"}]},{id:"orff",name:"Orff",sounds:[{register:"agudos",icon:"banks/orff/icons/flute.svg",sample:"recorder.wav"},{register:"agudos",icon:"holder.js/40x40?text=O2",sample:"snap.mp3"},{register:"agudos",icon:"holder.js/40x40?text=O3",sample:"snap.mp3"},{register:"agudos",icon:"holder.js/40x40?text=O3",sample:"snap.mp3"},{register:"medios",icon:"banks/orff/icons/xylophone.svg",sample:"xylophone.wav"},{register:"medios",icon:"holder.js/40x40?text=O6",sample:"snap.mp3"},{register:"medios",icon:"holder.js/40x40?text=O7",sample:"snap.mp3"},{register:"medios",icon:"holder.js/40x40?text=O7",sample:"snap.mp3"},{register:"graves",icon:"banks/orff/icons/marimba.png",sample:"marimba.wav"},{register:"graves",icon:"holder.js/40x40?text=O10",sample:"snap.mp3"},{register:"graves",icon:"holder.js/40x40?text=O11",sample:"snap.mp3"},{register:"graves",icon:"holder.js/40x40?text=O11",sample:"snap.mp3"}]}],a=n("8cc4"),c=n.n(a);r["default"].use(s["a"]);var l=new s["a"].Store({state:{banks:i,bankActive:"aula",sampleActive:null,bpm:60,dot:3,dots:[2,3,4],dotActive:-1,notes:[],players:{},playing:!1,showSheet:!0,isPwa:!1,isEraserOn:!1},getters:{bank:function(t){return t.banks.find((function(e){return e.id===t.bankActive}))},ndots:function(t){return 2*t.dot},getIcon:function(t,e){return function(t,n){return e.getBank(t).sounds.find((function(t){return t.sample===n})).icon}},getBank:function(t){return function(e){return t.banks.find((function(t){return t.id===e}))}}},mutations:{changeDot:function(t,e){e!==t.dot&&(t.dot=e)},togglePlaying:function(t){t.playing=!t.playing},setPlaying:function(t,e){t.playing=e},setDotActive:function(t,e){t.dotActive=e},setSampleActive:function(t,e){t.sampleActive=e,t.isEraserOn=!1},toggleEraser:function(t){t.isEraserOn||(t.sampleActive=null),t.isEraserOn=!t.isEraserOn},setNote:function(t,e){var n=e.idx,r=e.note;t.notes[n]=r},clearNote:function(t,e){t.notes[e]=d()},setNotes:function(t,e){t.notes=e},clearNotes:function(t){t.notes.forEach((function(t){t.sample="",t.bank=""}))},setIsPwa:function(t,e){t.isPwa=e},changeBankActive:function(t,e){t.bankActive=e},toggleSheet:function(t){t.showSheet=!t.showSheet},setBpm:function(t,e){t.bpm=e},loadBank:function(t,e){if(console.log("Trying to load bank ".concat(e)),t.players[e])console.log("Soundbank ".concat(e," is already loaded"));else{var n=t.banks.find((function(t){return t.id===e})),r=n.sounds,o=r.map((function(t){return"banks/".concat(e,"/sounds/").concat(t.sample)})),s={};o.forEach((function(t,e){return s[r[e].sample]=t})),t.players[e]=new c.a.Players(s).toMaster(),console.log("Loaded bank ".concat(e))}}}}),u=l;function d(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return{bank:t,sample:e}}var p=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("Transition",{attrs:{appear:"","appear-active-class":"animated fadeIn slow"}},[n("div",{attrs:{id:"subapp"}},[n("h2",{staticClass:"header"},[t._v("CAÇA SONS")]),n("Soundbanks",{attrs:{id:"soundbanks"}}),n("Shape",{attrs:{id:"shape"}}),n("BpmChooser",{attrs:{id:"bpms"}}),n("div",{attrs:{id:"dotsChooser"}},t._l(t.dots,(function(e,r){return n("span",{key:r},[n("span",{staticClass:"possibleDot",class:{active:e===t.dot},on:{click:function(n){return n.preventDefault(),n.stopPropagation(),t.changeDot(e)},touchstart:function(n){return n.preventDefault(),n.stopPropagation(),t.changeDot(e)}}},[t._v(t._s(e))]),r!==t.dots.length-1?n("span",[t._v(" / ")]):t._e()])})),0),n("Controls",{attrs:{id:"controls"}}),n("div",{attrs:{id:"secondaryControls"}},[n("ul",[n("li",[n("FontAwesomeIcon",{staticClass:"trash",attrs:{icon:"trash"},on:{click:t.trash}})],1),n("li",[n("FontAwesomeIcon",{staticClass:"trash",class:{eraserActive:t.isEraserOn},attrs:{icon:"eraser"},on:{click:function(e){return t.$store.commit("toggleEraser")}}})],1)])]),n("div",{attrs:{id:"sheetToggle"},on:{click:function(e){return t.toggleSheet()}}},[n("Transition",{attrs:{"enter-active-class":"animated fadeIn faster","leave-active-class":"animated fadeOut faster",mode:"out-in"}},[t.showSheet?n("FontAwesomeIcon",{key:"minus",attrs:{icon:"minus"}}):n("FontAwesomeIcon",{key:"plus",attrs:{icon:"plus"}})],1)],1),n("Transition",{attrs:{"enter-active-class":"animated bounceInDown","leave-active-class":"animated bounceOutUp"}},[n("SheetVexFlow",{directives:[{name:"show",rawName:"v-show",value:t.showSheet,expression:"showSheet"}],attrs:{id:"sheet"}})],1)],1)])},f=[],h=(n("8e6e"),n("456d"),n("c5f6"),n("04ff"),n("386d"),n("bd86")),g=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("table",{staticClass:"soundbank"},[n("tr",[n("th",{staticClass:"bank-title",attrs:{colspan:"100%"}},[n("span",{staticClass:"left",class:{disabled:t.firstBank},on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.change(-1)},touchstart:function(e){return e.preventDefault(),e.stopPropagation(),t.change(-1)}}},[t._v("←")]),t._v("\n            "+t._s(t.bank.name)+"\n            "),n("span",{staticClass:"right",class:{disabled:t.lastBank},on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.change(1)},touchstart:function(e){return e.preventDefault(),e.stopPropagation(),t.change(1)}}},[t._v("→")])])]),t._l(t.registers,(function(e){return n("tr",{key:e},[n("th",[t._v("\n            "+t._s(t._f("wordize")(e))+"\n            ")]),t._l(t.getSounds(e,t.bank.id),(function(e,r){return n("td",{key:r},[e.icon.includes("holder")?n("img",{directives:[{name:"holder",rawName:"v-holder",value:e.icon,expression:"sound.icon"}]}):n("img",{class:{active:t.sampleActive===e},attrs:{src:e.icon,alt:"image for "+e.icon,"data-sample":e.sample},on:{dragstart:function(n){return t.drag(n,e)},dragend:t.dragend,click:function(n){return n.preventDefault(),n.stopPropagation(),t.touchstart(e)},touchstart:function(n){return n.preventDefault(),n.stopPropagation(),t.touchstart(e)}}})])}))],2)}))],2)},v=[],m=(n("20d6"),n("b95c")),b=n.n(m);function y(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function O(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?y(Object(n),!0).forEach((function(e){Object(h["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}r["default"].use(b.a);var k={name:"Soundbanks",filters:{wordize:function(t){return"agudos"===t?"Agudos":"medios"===t?"Médios":"graves"===t?"Graves":void 0},firstLetter:function(t){return t.charAt(0).toUpperCase()}},data:function(){return{registers:["agudos","medios","graves"],dragging:!1}},computed:O({},Object(s["d"])(["banks","sampleActive","players"]),{},Object(s["b"])(["bank"]),{firstBank:function(){return this.bank.id===this.banks[0].id},lastBank:function(){return this.bank.id===this.banks[this.banks.length-1].id}}),mounted:function(){this.$store.commit("loadBank",this.bank.id)},methods:O({},Object(s["c"])(["loadBank","changeBankActive","setSampleActive"]),{getSounds:function(t,e){var n=this.banks.find((function(t){return t.id===e}));return n.sounds.filter((function(e){return e.register===t}))},change:function(t){var e=this,n=this.banks.findIndex((function(t){return t.id===e.bank.id}));n+t>=this.banks.length||n+t<0||(this.changeBankActive(this.banks[n+t].id),this.loadBank(this.bank.id))},drag:function(t,e){this.dragging=!0,this.touchstart(e),t.dataTransfer.setData("sample",t.target.getAttribute("data-sample")),t.dataTransfer.setData("src",t.target.src)},dragend:function(){this.dragging=!1},touchstart:function(t){var e=t!==this.sampleActive?t:void 0;this.dragging&&void 0===e&&(e=this.sampleActive),this.setSampleActive(e)}})},x=k,w=(n("251f"),n("2877")),j=Object(w["a"])(x,g,v,!1,null,null,null),S=j.exports,P=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"shape",on:{shake:t.shaked}},[n("svg",{attrs:{id:"svg",width:"100%",height:"100%"}},[n("g",{staticClass:"lines"},t._l(t.lines,(function(t,e){return n("path",{key:e,staticClass:"animated fadeIn slow",attrs:{stroke:"black","stroke-width":"10",fill:"none",d:"M"+t.x1+" "+t.y1+" Q "+t.x3+" "+t.y3+" "+t.x2+" "+t.y2}})})),0),n("g",{staticClass:"dots"},t._l(t.dots,(function(e,r){return n("g",{key:"dot-"+r},[n("circle",{key:r,ref:"dot-"+r,refInFor:!0,staticClass:"dot animated",class:{active:r===t.dotActive},attrs:{cx:e.x,cy:e.y,"data-dot":r,r:e.isSmall?.75*t.r:t.r},on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.click(e,r)},dragover:function(e){return e.stopPropagation(),t.drag(e)},drop:function(e){return t.click(e,r)}}}),n("image",t._b({staticClass:"draggable",attrs:{set:t.factor=e.isSmall?.6:.8,x:e.x-t.r*t.factor,y:e.y-t.r*t.factor,width:2*t.r*t.factor,height:2*t.r*t.factor,"data-dot":r},on:{dragover:function(e){return e.preventDefault(),e.stopPropagation(),t.drag(e)},drop:function(e){return e.preventDefault(),t.click(e,r)},click:function(e){return e.ctrlKey||e.shiftKey||e.altKey||e.metaKey?null:t.click(e,r)},touchstart:function(e){return t.click(r)},xdragstart:function(e){return t.dragstart(e,r)},xdrag:t.drag,xdragend:function(e){return t.dragend(e,r)},mouseup:function(e){return"button"in e&&1!==e.button?null:t.remove(e,r)}}},"image",{"xlink:href":e.image},!1))])})),0)])])},A=[],D=n("f75e"),_=n.n(D),C=n("109c");function E(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function $(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?E(Object(n),!0).forEach((function(e){Object(h["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):E(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var I={name:"Shape",data:function(){return{dots:[],lines:[],r:22}},computed:$({},Object(s["d"])(["dot","dotActive","isEraserOn","players","playing","sampleActive"]),{},Object(s["b"])(["bank","ndots"])),watch:{dot:function(t,e){this.reset(t,e),this.update()}},created:function(){for(var t=0;t<this.ndots;t++)this.dots.push({x:0,y:0,image:"",isSmall:t%2===1})},mounted:function(){this.init(),this.$root.$on("dotchange",this.dotChanged),this.$root.$on("dotstep",this.dotStepped),this.$root.$on("dotsclear",this.clear)},methods:$({},Object(s["c"])(["setDotActive","setNote","clearNote"]),{init:function(){var t=this;this.loop=new c.a.Loop((function(e){var n=t.dotActive,r=(t.dotActive+1)%t.ndots;t.setDotActive(r),t.previousActiveDot=n;var o=t.dotActive,s=t.$store.state.notes[o];t.$root.$emit("dotstep",{idx:o,note:s,time:e})}),"8n").start(0),this.update(!1),this.initShake()},initShake:function(){new _.a({threshold:10,timeout:1e3}).start()},shaked:function(){console.log("i got shaken"),this.reset()},dotChanged:function(t){var e=t.idx,n=t.src,o=t.sample;e>=this.dots.length||(r["default"].set(this.dots[e],"image",n),r["default"].set(this.dots[e],"sample",o))},reset:function(t,e){var n=this,r=t-e,o=this.dot;if(r<0){var s=2*t;this.dots=this.dots.slice(0,s),this.lines=this.lines.slice(0,o)}else{var i=function(t){t.forEach((function(t){n.dots.push({x:n.dots[t].x,y:n.dots[t].y,image:"",isSmall:n.dots.length%2===1})}))},a=function(t){t.forEach((function(t){var e=t[0],r=t[1],o=n.dots[e].x,s=n.dots[e].y,i=n.dots[r].x,a=n.dots[r].y,c=(o+i)/2,l=(s+a)/2;n.lines.push({x1:o,x2:i,y1:s,y2:a,x3:c,y3:l})}))};3===e&&4===t?(i([0,0]),a([[6,0]])):2===e&&3===t?(i([0,0]),a([[0,4]])):2===e&&4===t&&(i([0,0,0,0]),a([[2,4],[4,6]]))}},clear:function(){this.dots.forEach((function(t){t.image="",t.sample=""}))},dotStepped:function(t){var e=t.idx,n=t.note,r=t.time;console.log("dotStepped",{idx:e,note:n,time:r});var o=this.r,s=this.$refs["dot-".concat(e)],i=.08,a=e%2===1?.75*this.r:this.r;if(C["a"].to(s,i,{attr:{r:1.5*o},onComplete:function(){C["a"].to(s,i,{attr:{r:a}})}}),n&&""!==n.sample){var c=0===e?0:-6;this.players[n.bank].volume.value=c,this.players[n.bank].get(n.sample).start(r)}},update:function(){var t=this,e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],n=this.$el.clientWidth,o=this.$el.clientHeight,s=this.r,i=.5*s,a=s+i,c=n-i-s,l=n/2,u=c-a,d=a,p=o-i-s,f=p-Math.sqrt(Math.pow(u,2)-Math.pow(u/2,2)),h=(p-d)/2+d,g=.8,v=function(e,n,o){var s=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];s?C["a"].to(t.dots[e],g,{x:n,y:o}):(r["default"].set(t.dots[e],"x",n),r["default"].set(t.dots[e],"y",o))},m=function(n,o,s,i,a){var c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:(o+i)/2,l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:(s+a)/2;t.lines[n]||t.lines.splice(n,1,{x1:o,y1:s,x2:i,y2:a}),e?C["a"].to(t.lines[n],g,{x1:o,y1:s,x2:i,y2:a,x3:c,y3:l}):(r["default"].set(t.lines[n],"x1",o),r["default"].set(t.lines[n],"y1",s),r["default"].set(t.lines[n],"x2",i),r["default"].set(t.lines[n],"y2",a),r["default"].set(t.lines[n],"x3",c),r["default"].set(t.lines[n],"y3",l))},b=(p-d)/2+d;switch(this.dot){case 2:v(0,l,d,e),v(1,l+u/4,b,e),v(2,l,p,e),v(3,l-u/4,b,e),m(0,l,d,l,p,l+u/2,b),m(1,l,p,l,d,l-u/2,b);break;case 3:v(0,l,f,e),v(1,(l+c)/2,(f+p)/2,e),v(2,c,p,e),v(3,l,p,e),v(4,a,p,e),v(5,(a+l)/2,(f+p)/2,e),m(0,l,f,c,p),m(1,c,p,a,p),m(2,a,p,l,f);break;case 4:default:v(0,a,d,e),v(1,l,d,e),v(2,c,d,e),v(3,c,h,e),v(4,c,p,e),v(5,l,p,e),v(6,a,p,e),v(7,a,h,e),m(0,a,d,c,d),m(1,c,d,c,p),m(2,c,p,a,p),m(3,a,p,a,d);break}},click:function(t,e){if(this.sampleActive||this.isEraserOn){if(this.isEraserOn)return this.clearNote(e),void this.$root.$emit("dotchange",$({idx:e},d(),{src:""}));var n=d(this.bank.id,this.sampleActive.sample);this.setNote({idx:e,note:n}),this.$root.$emit("dotchange",$({idx:e},n,{src:document.querySelector("img.active").getAttribute("src")}))}},drag:function(){console.log("dragging a shape")},remove:function(t,e){console.log("removing",t,e);var n=d("","");this.setNote({idx:e,note:n}),this.$root.$emit("dotchange",$({idx:e},n,{src:""}))}})},N=I,B=(n("44bd"),Object(w["a"])(N,P,A,!1,null,null,null)),F=B.exports,T=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"bpms"},t._l(t.options,(function(e,r){return n("div",{key:e,staticClass:"bpm",class:{active:e===t.bpm,"prev-active":r===t.optionActiveIdx-1,"next-active":r===t.optionActiveIdx+1},on:{click:function(n){return n.preventDefault(),n.stopPropagation(),t.change(e)},touchstart:function(n){return n.preventDefault(),n.stopPropagation(),t.change(e)}}},[t._v("\n        "+t._s(e)+"\n    ")])})),0)},V=[];function M(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function G(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?M(Object(n),!0).forEach((function(e){Object(h["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):M(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var q={name:"BpmChooser",data:function(){return{options:[44,52,60,80,100,120,140]}},computed:G({},Object(s["d"])(["bpm"]),{optionActiveIdx:function(){var t=this;return this.options.findIndex((function(e){return e===t.bpm}))}}),mounted:function(){this.change(this.bpm)},methods:G({},Object(s["c"])(["setBpm"]),{change:function(t){this.setBpm(t),c.a.Transport.bpm.value=this.bpm}})},z=q,L=(n("0a36"),Object(w["a"])(z,T,V,!1,null,null,null)),R=L.exports,K=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"controls"},[!t.isPwa&&t.isFullscreenCapable?n("div",{staticClass:"control fullscreen"},[n("FontAwesomeIcon",{attrs:{icon:"expand"},on:{click:t.toggleFullscreen}}),n("span",[t._v("FULLSCREEN")])],1):n("div"),n("div",{staticClass:"control"},[n("FontAwesomeIcon",{staticClass:"play",attrs:{icon:["far",t.playing?"stop-circle":"play-circle"]},on:{click:function(e){return t.$store.commit("togglePlaying")}}}),n("span",[t._v(t._s(t.playing?"STOP":"PLAY"))])],1),n("div",{staticClass:"control"},[n("FontAwesomeIcon",{attrs:{icon:["far","dot-circle"]},on:{click:function(e){return t.record()}}}),n("span",{class:{"recording animated flash infinite slow":t.recording}},[t._v("REC")])],1)])},U=[],W=n("93bf"),H=n.n(W),J=n("21a6"),Q=n.n(J),Y=n("ecee"),X=n("c074"),Z=n("b702"),tt=n("ad3d");function et(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function nt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?et(Object(n),!0).forEach((function(e){Object(h["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):et(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}Y["c"].add(X["b"],Z["b"],Z["c"],Z["a"],X["e"],X["d"],X["f"],X["a"],X["c"]),r["default"].component("FontAwesomeIcon",tt["a"]);var rt={name:"Controls",data:function(){return{recording:!1}},computed:nt({},Object(s["d"])(["playing","dotActive","isPwa"]),{isFullscreenCapable:function(){return H.a.enabled}}),watch:{playing:function(){this.playing?this.play():this.stop()}},created:function(){this.recorder=new window.Recorder(c.a.Master.input)},methods:nt({},Object(s["c"])(["togglePlaying","setDotActive","setPlaying"]),{play:function(){"suspended"===c.a.context.state&&c.a.context.resume(),c.a.Transport.position="0:0:0",c.a.Transport.start()},stop:function(){c.a.Transport.stop(),this.setDotActive(-1),this.$root.$emit("stop")},record:function(){this.playing||this.setPlaying("true"),this.recording=!this.recording,this.recording?this.recorder.record():(this.recorder.stop(),this.recorder.exportWAV((function(t){Q.a.saveAs(t,"Gravação Caça Sons.wav")})),this.setPlaying(!1))},toggleFullscreen:function(){H.a.toggle()}})},ot=rt,st=(n("c386"),Object(w["a"])(ot,K,U,!1,null,null,null)),it=st.exports,at=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{ref:"container",staticClass:"sheetContainer"},[t.loaded?n("MountingPortal",{ref:"portal",attrs:{"mount-to":"#sheetId",append:"","target-tag":"g"}},[n("defs",[n("filter",{attrs:{id:"f1"}},[n("feComponentTransfer",{attrs:{"color-interpolation-filters":"sRGB"}},[n("feFuncR",{attrs:{type:"table",tableValues:"1 0"}}),n("feFuncG",{attrs:{type:"table",tableValues:"1 0"}}),n("feFuncB",{attrs:{type:"table",tableValues:"1 0"}})],1)],1)]),t._l(t.vfImages,(function(e,r){return n("image",t._b({key:r,attrs:{x:e.x,y:e.y,width:e.width,height:e.height,"data-idx":e.idx,"data-order":e.order}},"image",{"xlink:href":e.src,filter:e.playing?"":"url(#f1)"},!1))}))],2):t._e()],1)},ct=[],lt=n("2b88"),ut=n("05de"),dt=n.n(ut);function pt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function ft(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?pt(Object(n),!0).forEach((function(e){Object(h["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):pt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var ht=dt.a.Flow,gt={glyph_spacing_px:20,num_lines:5,space_above_staff_ln:1,space_below_staff_ln:1},vt={components:{MountingPortal:lt["MountingPortal"]},data:function(){return{vfImages:[],loaded:!1}},computed:ft({},Object(s["d"])(["notes","dot","banks"]),{},Object(s["b"])(["ndots","getIcon"])),watch:{dot:function(){this.createStave(),this.update()}},created:function(){this.$root.$on("dotstep",this.dotStepped),this.$root.$on("dotchange",this.dotChanged),this.$root.$on("dotsclear",this.clear),this.$root.$on("stop",this.stop),this.$root.$on("debouncedresize",this.resize),this.vfNotes=this.getVfNotes()},mounted:function(){this.init(),this.update(),this.loaded=!0},methods:{resize:function(){console.log("debounce resizing in vexflow")},createStave:function(){this.staveGroup&&this.context.svg.removeChild(this.staveGroup);var t=this.$el.clientWidth;this.stave=new ht.Stave(0,0,t,gt),this.stave.addTimeSignature("".concat(this.dot,"/4")),this.staveGroup=this.context.openGroup(),this.stave.setContext(this.context).draw(),this.context.closeGroup(),this.context.svg.insertBefore(this.staveGroup,this.group)},init:function(){var t=document.querySelector(".sheetContainer > svg");t&&(this.clearSvg(),t.remove()),this.renderer=new ht.Renderer(document.querySelector(".sheetContainer"),ht.Renderer.Backends.SVG);var e=this.$el.clientWidth;this.renderer.resize(.75*e,200),this.renderer.ctx.svg.setAttribute("id","sheetId"),this.context=this.renderer.getContext();var n=1.25;this.context.scale(n,n),this.renderer.ctx.svg.style.position="relative",this.renderer.ctx.svg.style.left="-".concat(e*(n-1),"px"),this.createStave()},getVfNotes:function(){for(var t=this,e=[],n=function(n){var o=t.notes[n],s=""===o.sample,i=n%2===0,a=n!==t.notes.length-1&&""===t.notes[n+1].sample,c=s&&i&&a,l=o.bank,u=void 0;if(l){var d=t.banks.find((function(t){return t.id===o.bank})),p=d.sounds.find((function(t){return t.sample===o.sample})).register;"graves"===p?u="e":"medios"===p?u="g":"agudos"===p&&(u="b")}var f={keys:s?["b/4"]:["".concat(u,"/4")],duration:c?"4r":s?"8r":"8"};c&&n++,e.push(new ht.StaveNote(f)),e.forEach((function(t){return t.setStyle({fillStyle:"black",strokeStyle:"black"})})),r=n},r=0;r<this.notes.length;r++)n(r);return e},update:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.clearSvg(),this.group=this.context.openGroup("vfNotes"),this.vfNotes=this.getVfNotes(),t&&(this.draw(),this.drawIcons()),this.group.parentNode.insertBefore(this.group,this.$el.querySelector(".vue-portal-target"))},drawIcons:function(){this.vfImages=[];for(var t=0;t<this.ndots;t++){var e=this.convertNoteIdxToVfNoteIdx(t),n=this.vfNotes[e],r=this.notes[t],o=r.bank,s=r.sample;if(s){var i=n.note_heads[0],a=i.x,c=i.y;if(n.attrs.el){var l=n.attrs.el.querySelector(".vf-notehead"),u=l.getBoundingClientRect(),d=u.width,p=u.height,f=.7;p*=f;var h=this.getIcon(o,s);this.vfImages.push({vfIdx:e,x:a-d/8,y:c-p/2,width:d,height:p,src:h,playing:!1,order:this.vfImages.length,idx:t})}}}},clearSvg:function(){this.group&&(this.context.svg.removeChild(this.group),this.group=null)},draw:function(){var t=this,e=ht.Beam.generateBeams(this.vfNotes);ht.Formatter.FormatAndDraw(this.context,this.stave,this.vfNotes),e.forEach((function(e){e.setStyle({fillStyle:"black",strokeStyle:"black"}),e.setContext(t.context).draw()})),this.context.closeGroup()},stop:function(){var t=document.querySelectorAll("#sheet path[fill='var(--accent)']");t.forEach((function(t){return t.removeAttribute("fill")}));var e=document.querySelectorAll("#sheet path[stroke='var(--accent)");e.forEach((function(t){return t.setAttribute("stroke","black")}))},dotChanged:function(){this.update()},convertVfDurationToHuman:function(t){return"4"===t.charAt(0)?1:"8"===t.charAt(0)?.5:void 0},convertNoteIdxToVfNoteIdx:function(t){var e=this,n=.5*t,r=function t(r,o,s){if(r>n)return s-1;if(r===n)return s;var i=o[s].duration,a=e.convertVfDurationToHuman(i);return t(r+a,o,++s)},o=r(0,this.vfNotes.slice(0),0);return o},dotStepped:function(t){var e=t.idx,n=this.convertNoteIdxToVfNoteIdx(e);try{this.update(!1),this.vfNotes[n].setStyle({fillStyle:"var(--accent)",strokeStyle:"var(--accent)"}),this.draw(),this.vfImages.forEach((function(t){return t.playing=!1}));var r=this.$el.querySelector("image[data-idx='".concat(e,"']"));if(r){var o=r.getAttribute("data-order");this.vfImages.forEach((function(t){return t.playing=!1})),this.vfImages[o].playing=!0}}catch(s){console.error("tried to highlight an invalid vfNote",s.stack)}},clear:function(){this.vfNotes=[],this.clearSvg(),this.update()}},render:function(t){return t()}},mt=vt,bt=Object(w["a"])(mt,at,ct,!1,null,null,null),yt=bt.exports;function Ot(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function kt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Ot(Object(n),!0).forEach((function(e){Object(h["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ot(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var xt={name:"App",components:{BpmChooser:R,Controls:it,Shape:F,SheetVexFlow:yt,Soundbanks:S},data:function(){return{bpms:[44,52,60,80,100,120,140]}},computed:kt({},Object(s["d"])(["banks","dot","dots","isEraserOn","isPwa","notes","playing","sampleActive","showSheet"]),{},Object(s["b"])(["ndots"])),watch:{dot:function(){var t=this.ndots-this.notes.length;if(t>0)for(var e=0;e<t;e++)this.notes.push(d());else this.setNotes(this.notes.slice(0,this.ndots));this.playing&&t<0&&this.dotActive>=this.notes.length&&this.setDotActive(-1)}},created:function(){var t=this;document.addEventListener("keypress",this.keypress),window.addEventListener("resize",(function(){t.$root.$emit("debouncedresize")})),this.$store.commit("setIsPwa","homescreen"===new URLSearchParams(window.location.search).get("utm_source"));for(var e=0;e<this.ndots;e++)this.notes.push(d());this.banks.forEach((function(t){t.sounds.forEach((function(t){(new Image).src=t.icon}))}))},methods:kt({},Object(s["c"])(["changeDot","setDotActive","setNotes","toggleEraser","togglePlaying","toggleSheet"]),{trash:function(){this.$store.commit("clearNotes"),this.$root.$emit("dotsclear")},keypress:function(t){switch(t.key){case" ":this.togglePlaying();break;case"2":case"3":case"4":this.changeDot(Number.parseInt(t.key));break}}})},wt=xt,jt=(n("5c0b"),Object(w["a"])(wt,p,f,!1,null,null,null)),St=jt.exports,Pt=n("dc21"),At=n("e594");r["default"].config.productionTip=!1,Pt["a"]({dsn:"https://d82cf1aeb5684dab87c8c13535def305@sentry.io/1384417",integrations:[new At["a"]({Vue:r["default"],attachProps:!0})]}),new r["default"]({store:u,render:function(t){return t(St)}}).$mount("#app")},"5c0b":function(t,e,n){"use strict";var r=n("e332"),o=n.n(r);o.a},"5fef":function(t,e,n){},"850a":function(t,e,n){},b912:function(t,e,n){},c386:function(t,e,n){"use strict";var r=n("d03c"),o=n.n(r);o.a},d03c:function(t,e,n){},e332:function(t,e,n){}});
//# sourceMappingURL=app.a58a0d47.js.map